<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>reveal.js - The HTML Presentation Framework</title>

		<meta name="description" content="Description">
		<meta name="author" content="Author">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/default.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">
            <div class="slides"><section><h3>Build automation / task runners</h3><aside class="notes">- Build automation in general
  - make
  - ninja
  - phing
  - grunt
  - gulp js
  - ant
  - maven
  - gradle
  - features
    - incremental fields
    - dependency graphs
    - plugins
    - package management
  - tasks
    - concatenation
    - glob-to-glob
    - cache busting 
  - gulp js
    - vinyl fs
    - createReadStream
    - Buffers vs Streams
  - Assets!
    - Rails
    - Laravel
    - Flask
- sources
  - </aside></section><section><section><h3>GNU Make</h3><p>DSL for compiling <em>files</em></p><pre><code data-trim="data-trim">-- Makefile
hello: hello.c
</code></pre><pre><code data-trim="data-trim">$ make hello
cc -o hello hello.c

$ make hello
make: 'hello' er tidssvarende

</code></pre></section><section><h3>GNU Make</h3><p>Use file dependencies and modification time</p><pre><code data-trim="data-trim"># Makefile
hello: hello.c
</code></pre><pre><code data-trim="data-trim"># Catch system calls from process
$ strace -e stat "make hello"
...
stat("hello", {st_mode=S_IFREG|0775, st_size=8559, ...}) = 0
stat("hello.c", {st_mode=S_IFREG|0664, st_size=61, ...}) = 0
...</code></pre><pre><code data-trim="data-trim">make: 'hello' er tidssvarende.
</code></pre></section><section><h3>GNU Make </h3><p>Rules</p><pre><code data-trim="data-trim"># Makefile
fisk.js: fisk.coffee

%.js: %.coffee
  coffee < $< > $@
  </code></pre></section><section><h3>GNU Make</h3><pre><code data-trim="data-trim">JS_FINAL = js/project-name-all.js
JS_TARGETS = $(shell find js -name "*.js")
JS_MINIFIED = $(JS_TARGETS:.js=.min.js)

all: $(JS_FINAL)

# Concat
$(JS_FINAL): $(JS_MINIFIED)
  cat $^ >$@
  rm -f $^
  
%.min.js: %.js
  uglifyjs -o $@ $<
  echo >> $@
  
clean:
  rm -f $(JS_FINAL)
  </code></pre></section><section style="text-align: left"><h3>Score</h3><ul style="list-style-type: none;"><li>+ ubiquitous</li><li>+ dependency flow/declarative = brain candy</li><li>+ file dependencies</li><li>+/- DSL</li><li>- windows</li><li>- frills: log, watch, etc.</li></ul></section><section><p>Actually build system, but great project "menu" and tool abstraction layer</p><a href="http://bost.ocks.org/mike/make/">[Why use make]</a><pre><code data-trim="data-trim"># Makefile
.PHONY: migrate js

migrate:
  php artisan migrate --env=development
  
js:
  # grunt build
  gulp
  </code></pre><pre><code data-trim="data-trim">$ make migrate

$ make js
</code></pre><p>Could also use npm/composer "scripts"</p><pre><code data-trim="data-trim">$ composer run-script migrate
</code></pre></section></section><section><section><h3>Many build systems</h3><p>At least one pr language</p><ul><li>Rake</li><li>Cake</li><li>Shake</li><li>pmake</li><li>nmake</li><li>cmake</li><li>scons</li></ul></section><section><h3>phing, what?<pre><code data-trim="data-trim" style="font-size: 9pt; line-height: 1.3em;"><?xml version="1.0" encoding="UTF-8"?>
<project name="FooBar" default="dist">
    <target name="prepare">
        <echo msg="Making directory ./build" />
        <mkdir dir="./build" />
    </target>
    <target name="build" depends="prepare">
        <echo msg="Copying files to build directory..." />
        <echo msg="Copying ./about.php to ./build directory..." />
        <copy file="./about.php" tofile="./build/about.php" />
        <echo msg="Copying ./browsers.php to ./build directory..." />
        <copy file="./browsers.php" tofile="./build/browsers.php" />
        <echo msg="Copying ./contact.php to ./build directory..." />
        <copy file="./contact.php" tofile="./build/contact.php" />
    </target>
    <target name="dist" depends="build">
        <echo msg="Creating archive..." />
        <tar destfile="./build/build.tar.gz" compression="gzip">
            <fileset dir="./build">
                <include name="*" />
            </fileset>
        </tar>
        <echo msg="Files copied and compressed in build directory OK!" />
    </target>
</project>
</code></pre></h3></section><section><h3>New</h3><p>redo, fabricate.py, Tup, ninja, shake</p><p>Aim for make, with virtual fs, etc.</p></section></section><section><section><h3>Grunt, so 2013</h3><em>The JavaScript task runner</em></section><section><h3>Tasks only, no dependencies</h3><p>Lots of plugins, though</p><p>coffee, less, stylus, jade...</p></section><section><pre><code data-trim="data-trim" style="font-size: 10pt; line-height: 1.3em;" class="language-js">// JavaScript
module.exports = function(grunt) {
  grunt.initConfig({
    pkg: grunt.file.readJSON('package.json'),
    concat: {
      options: {
        separator: ';'
      },
      dist: {
        src: ['src/**/*.js'],
        dest: 'dist/<%= pkg.name %>.js'
      }
    },
    uglify: {
      options: {
        banner: '/*! <%= pkg.name %> <%= grunt.template.today("dd-mm-yyyy") %> */\n'
      },
      dist: {
        files: {
          'dist/<%= pkg.name %>.min.js': ['<%= concat.dist.dest %>']
        }
      }
    },
    </code></pre><a href="http://git.ordbogen.com/nkn/educas-dk/blob/38890da100e02f87e3761eca2fb6c1f5d390ae46/Gruntfile.coffee">-> Educas.dk</a></section><section style="text-align: left;"><h3>Score</h3><ul style="list-style-type: none;"><li>+ General purpose language</li><li>+ Logging</li><li>+ Watch*</li><li>- Not DSL</li><li>- No knowledge of dependencies</li><li>- Manual incremental builds (everything manual)</li></ul></section></section><section><section><h3>Gulp js</h3><p><em>The streaming build system</em></p><aside class="notes">Streams er en del af vinyl-fs, men det er et centralt og interessant koncept</aside></section><section><h3>Parts</h3><ul style="list-style-type: none;"><li>orchestrator</li><li>node streams</li><li>gaze</li><li>vinyl-fs</li></ul></section><section><h3>orchestrator</h3><p>Concurrent tasks</p><pre><code data-trim="data-trim">// takes in a callback so the engine knows when it'll be done
orchestrator.add('one', function (cb) {
    // do stuff -- async or otherwise
    cb(err);
});

// identifies a dependent task must be complete before this one begins
orchestrator.add('two', ['one'], function () {
    // task 'one' is done now
});

orchestrator.start('one', 'two');</code></pre></section><section><h3>node streams</h3><ul style="list-style-type:none;"><li><a href="http://nodejs.org/api/stream">nodejs.org/api/stream.html</a></li><li><a href="http://nodestreams.com">nodestreams.com</a></li></ul><pre><code data-trim="data-trim">readable.on('data', function(chunk) {
  console.log('got %d bytes of data', chunk.length);
})
readable.on('end', function() {
  console.log('there will be no more data.');
});</code></pre></section></section><section><section><h3>Bonus!</h3><p>Assets</p></section><section><h3>Rails-assets.org</h3><pre><code data-trim="data-trim" class="language-ruby"># Gemfile
source 'https://rails-assets.org'
gem 'rails'

gem 'rails-assets'
gem 'rails-assets-angular'
gem 'rails-assets-bootstrap'
</code></pre><pre><code data-trim="data-trim" class="language-js">// application.js
//= require angular

angular.module(...)
</code></pre><pre><code data-trim="data-trim">$ bundle install
$ rails server

</code></pre></section></section>    </div>
</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.min.js"></script>

<script>

    // Full list of configuration options available here:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        theme: Reveal.getQueryHash().theme || "default", // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || "default" || 'default', // default/cube/page/concave/zoom/linear/none

        // Optional libraries used to extend on reveal.js
        dependencies: [
            { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
            { src: 'plugin/markdown/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
            { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
            { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
            { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
            { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
            // { src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
    });

</script>
</body>
</html>
        